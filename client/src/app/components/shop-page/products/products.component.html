<div class="bc-icons-2">
  <mdb-breadcrumb customClass="white">
    <div class="container">

      <mdb-breadcrumb-item>
        <mdb-breadcrumb-item [routerLink]="'/'">Главная</mdb-breadcrumb-item>
        <mdb-breadcrumb-item class="active">Продукты</mdb-breadcrumb-item>
      </mdb-breadcrumb-item>
    </div>
  </mdb-breadcrumb>
</div>


  <div class="container">
  <div class="row pt-0 pb-0">
    <div class="col-sm-9 order-2">
      <div class="d-flex justify-content-end">
      <select class="browser-default"  [(ngModel)]="sort">
        <option value="-date">Новые поступления</option>
        <option value="cost">Цена (low to high)</option>
        <option value="-cost">Цена (high to low)</option>
        <option value="name">Название А-Я</option>
        <option value="-name">Название Я-А</option>
        <option value="-sale">Распродажа</option>
      </select>
      </div>
      <!--Section: Products v.3-->
      <section class="text-center pb-3 my-5">
        <!--Grid row-->
        <div class="row" *ngIf="products$ | async  as products; else loading">
          <!--Grid column-->
          <div class="col-lg-3 col-md-6 mb-4"
               *ngFor="let prod of products | orderBy: sort | paginate: { itemsPerPage: 24, currentPage: page } | searchProduct: searchStr;">

            <!--Card-->
            <mdb-card class="align-items-center">

              <div class="view">
                <img src="{{prod.img[0].path}}" class="img-fluid " alt="zoom">
                <div class="mask waves-effect">
                  <p class="white-text"><mdb-badge *ngIf="prod.sale" pill="true" danger="true">Распродажа!</mdb-badge>
                  </p>
                </div>

                <a [routerLink]="['item', prod._id]">
                  <div class="mask rgba-white-slight"></div>
                </a>
              </div>
              <!--Card image-->

              <!--Card content-->
              <mdb-card-body class="text-center">
                <!--Category & Title-->
                <a href="" class="grey-text">
                </a>
                <h5>
                  <strong>
                    <a [routerLink]="['item', prod._id]" href="" class="dark-grey-text">{{prod.name}}

                    </a>
                  </strong>
                </h5>

                <h4 class="font-weight-bold blue-text">
                  <strong>{{prod.cost | number}} MDL</strong>
                </h4>

              </mdb-card-body>
              <!--Card content-->

            </mdb-card>
            <!--Card-->

          </div>
          <!--Grid column-->

        </div>
        <!--Grid row-->

      </section>
      <!--Section: Products v.3-->

    </div>


    <div class="col-sm-3 order-1 border-right">

      <!-- Search form -->
      <div class="form-inline md-form form-sm active-cyan-2 border pl-3">
        <input class="form-control form-control-sm mr-1 w-75 pl-3" type="text" placeholder="Найти товар..." [(ngModel)]="searchStr" aria-label="Search"
               mdbInput>
        <mdb-icon fas icon="search" aria-hidden="true"></mdb-icon>
      </div>

      <hr>

      <div>
        <div class="list-group my-2 py-2">
          <a (click)="defaultPage()" [routerLink]="'/products'"  class="list-group-item active waves-light text-white text-center" mdbWavesEffect>
            Все товары
          </a>
        </div>
      </div>

      <div>
        <div class="list-group my-2 py-2">
          <a (click)="defaultPage()" [routerLink]="'/industrial'"  class="list-group-item active waves-light text-white text-center" mdbWavesEffect>
            Промышленное
          </a>
        </div>
      </div>



      <ng-container *ngIf="productCategory$ | async as productCategory">


        <div *ngFor="let pcategory of productCategory" class="list-group my-2 py-2">
          <a  (click)="test.toggle()" class="list-group-item active waves-light text-white "  mdbWavesEffect>
            {{pcategory.name}}
          </a>
          <!--          [isCollapsed]="false" -->
          <div mdbCollapse  #test="bs-collapse">
            <div *ngIf="subproductCategory$ | async as productSubCategory">
              <ng-container *ngFor="let psubcategory of productSubCategory">
                <ng-container *ngIf="pcategory._id === psubcategory.category">
                  <a (click)="defaultPage()"  [routerLink]="['/products/subcategory', psubcategory._id]"
                     class="list-group-item list-group-item-action waves-light "> {{psubcategory.name}}</a>
                </ng-container>
              </ng-container>
            </div>
          </div>
        </div>
      </ng-container>


    </div>

  </div>

  <div class="flex-center">
    <pagination-controls
      (pageChange)="pageChanged($event)"
      (pageChange)="page = $event"
    >

    </pagination-controls>
  </div>

  <ng-template #loading>
    <p class="text-center">Загружаю продукты...</p>
  </ng-template>
